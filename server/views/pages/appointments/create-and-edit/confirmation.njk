{% extends "layout.njk" %}

{% from "govuk/components/panel/macro.njk" import govukPanel %}
{% from "govuk/components/summary-list/macro.njk" import govukSummaryList %}
{% from "pages/appointments/partials/appointment-journey-title.njk" import appointmentJourneyTitle %}

{% set pageTitle = appointmentJourneyTitle("Confirmation", session.appointmentJourney) %}
{% set pageId = 'appointments-create-confirmation-page' %}
{% set backLinkHref = "/appointments/" + appointmentId + "/occurrence/" + occurrenceId %}

{% block content %}
    <div class="govuk-grid-row">
        <div class="govuk-grid-column-two-thirds">
            {{ govukPanel({
                titleText: "Appointment created"
            }) }}
            <p class="govuk-body" data-qa="message">
                {% if appointment.appointmentType == AppointmentType.INDIVIDUAL %}
                    You have successfully created an appointment{{ (" series" if appointment.repeat != null) }} for {{ appointment.prisoners[0] | fullName | toTitleCase }}
                {% elseif appointment.appointmentType == AppointmentType.GROUP %}
                    You have successfully created an appointment{{ (" series" if appointment.repeat != null) }} for {{ appointment.prisoners | length }} prisoners
                {% endif %}
                {% if appointment.repeat == null %}
                    on {{ appointment.startDate | toDate | formatDate('EEEE, d MMMM yyyy') }}.
                {% else %}
                    starting on {{ appointment.startDate | toDate | formatDate('EEEE, d MMMM yyyy') }}.
                    It will repeat {{ ("every weekday (Monday to Friday)" if appointment.repeat.period == AppointmentRepeatPeriod.WEEKDAY) +
                                      ("daily (includes weekends)" if appointment.repeat.period == AppointmentRepeatPeriod.DAILY) +
                                      ("weekly" if appointment.repeat.period == AppointmentRepeatPeriod.WEEKLY) +
                                      ("fortnightly" if appointment.repeat.period == AppointmentRepeatPeriod.FORTNIGHTLY) +
                                      ("monthly" if appointment.repeat.period == AppointmentRepeatPeriod.MONTHLY) }}
                    for {{ appointment.repeat.count }}
                    {% if appointment.repeat.count == 1 %}
                        appointment
                    {% else %}
                        appointments
                    {% endif %}
                {% endif %}
            </p>

            <h2 class="govuk-heading-m">What you can do next</h2>
            <p class="govuk-body">
                <a href="/appointments" class="govuk-link govuk-link--no-visited-state" data-qa="create-another-link">Create another appointment</a>
            </p>
            <p class="govuk-body">
                <a href="/appointments/{{ appointment.id }}/occurrence/{{ appointment.occurrences[0].id }}" class="govuk-link govuk-link--no-visited-state" data-qa="view-appointment-link">View and manage appointment</a>
            </p>
        </div>
    </div>
{% endblock %}
