{% from "govuk/components/tag/macro.njk" import govukTag %}

{% macro showUnlockEvents(events) %}
    <div class="govuk-body govuk-!-margin-0 govuk-!-font-size-16">
        {% for e in events %}
            {% if not loop.first %}<hr class="mid-grey-tint-20-hr" />{% endif %}

            <div class="govuk-!-font-weight-bold">
                {% if e.eventType === 'ACTIVITY' and e.eventSource === 'SAA' %}
                    <a href="/attendance/activities/{{ e.scheduledInstanceId }}/attendance-list?preserveHistory=true"
                    class="govuk-link govuk-link--no-visited-state">
                        {{ e.summary | trim }}
                    </a>
                {% elseif e.eventType === 'APPOINTMENT' and e.eventSource === 'SAA'%}
                    <a href="/appointments/{{ e.appointmentId }}/occurrence/{{ e.appointmentOccurrenceId }}?preserveHistory=true"
                    class="govuk-link govuk-link--no-visited-state">
                        {{ e.summary | trim }}
                    </a>
                    {% if e.cancelled %}
                        <div>{{ govukTag({ text: 'Cancelled Appointment', classes: 'govuk-tag--small govuk-tag--red' }) }}</div>
                    {% else %}
                        <div>{{ govukTag({ text: 'Appointment', classes: 'govuk-tag--small' }) }}</div>
                    {% endif %}
                {% else %}
                    {{ e.summary | trim }}
                {% endif %}
            </div>

            {% if e.suspended %}
                <strong class="govuk-tag govuk-tag--red-border govuk-!-font-size-14">Prisoner suspended</strong>
            {% endif %}

            {% if e.eventType != 'EXTERNAL_TRANSFER' and e.eventType != 'COURT_HEARING' %}
                <div>{{ e.startTime }}{% if e.endTime %} - {{ e.endTime }}{% endif %}</div>
                <div>{{ "In cell" if e.inCell else e.internalLocationDescription | trim | title }}</div>
            {% endif %}

            {% if e.eventType === 'APPOINTMENT' and e.comments %}
                <div>{{ e.comments | trim | truncate(40) }}</div>
            {% endif %}
        {% endfor %}
    </div>
{% endmacro %}
